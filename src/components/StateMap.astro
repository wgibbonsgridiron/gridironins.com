---
const { states = [], title = "Coverage States" } = Astro.props;

// Map of state abbreviations to their paths in the SVG
const stateList = states.map((s:any) => s.toUpperCase());

const getStateClass = (state: string) => {
  const isActive = stateList.includes(state);
  return `transition-all duration-200 ${isActive ? 'fill-brand-500 dark:fill-brand-600 hover:fill-brand-600 dark:hover:fill-brand-500 cursor-pointer' : 'fill-slate-300 dark:fill-slate-700 hover:fill-slate-400 dark:hover:fill-slate-600'}`;
};

const statePaths = [
  { state: 'AK', path: 'M 120 520 L 100 500 L 80 510 L 70 500 L 60 515 L 50 505 L 40 520 L 30 510 L 20 530 L 35 545 L 50 540 L 65 555 L 80 550 L 95 565 L 110 560 L 120 540 Z' },
  { state: 'WA', path: 'M 80 80 L 140 80 L 138 120 L 75 118 Z' },
  { state: 'OR', path: 'M 75 120 L 138 122 L 136 175 L 70 173 Z' },
  { state: 'CA', path: 'M 70 175 L 136 177 L 120 300 L 90 295 L 55 250 Z' },
  { state: 'ID', path: 'M 140 82 L 180 90 L 175 160 L 138 155 Z' },
  { state: 'MT', path: 'M 182 90 L 310 95 L 308 150 L 178 145 Z' },
  { state: 'WY', path: 'M 180 162 L 308 165 L 305 230 L 178 227 Z' },
  { state: 'NV', path: 'M 120 180 L 175 182 L 155 270 L 118 265 Z' },
  { state: 'UT', path: 'M 157 182 L 210 185 L 208 255 L 157 252 Z' },
  { state: 'CO', path: 'M 212 185 L 330 190 L 328 255 L 210 250 Z' },
  { state: 'AZ', path: 'M 120 268 L 207 270 L 195 350 L 125 345 Z' },
  { state: 'NM', path: 'M 210 270 L 328 273 L 325 355 L 198 352 Z' },
  { state: 'TX', path: 'M 330 275 L 450 280 L 445 360 L 420 380 L 380 370 L 360 390 L 328 385 Z' },
  { state: 'ND', path: 'M 312 97 L 432 100 L 430 155 L 310 152 Z' },
  { state: 'SD', path: 'M 310 157 L 430 160 L 428 220 L 308 217 Z' },
  { state: 'NE', path: 'M 308 232 L 450 235 L 448 285 L 330 282 Z' },
  { state: 'KS', path: 'M 330 287 L 475 290 L 473 340 L 328 337 Z' },
  { state: 'OK', path: 'M 328 342 L 492 345 L 490 385 L 452 382 Z' },
  { state: 'MN', path: 'M 434 102 L 560 105 L 558 180 L 432 177 Z' },
  { state: 'IA', path: 'M 452 237 L 580 240 L 578 295 L 450 292 Z' },
  { state: 'MO', path: 'M 475 295 L 595 298 L 593 360 L 492 357 Z' },
  { state: 'AR', path: 'M 492 362 L 590 365 L 588 410 L 490 407 Z' },
  { state: 'LA', path: 'M 490 412 L 590 415 L 585 460 L 485 457 Z' },
  { state: 'WI', path: 'M 560 182 L 640 185 L 638 255 L 558 252 Z' },
  { state: 'IL', path: 'M 580 297 L 650 300 L 648 375 L 593 372 Z' },
  { state: 'MS', path: 'M 590 417 L 630 420 L 628 465 L 588 462 Z' },
  { state: 'MI', path: 'M 642 187 L 720 190 L 718 260 L 640 257 Z' },
  { state: 'IN', path: 'M 650 302 L 705 305 L 703 365 L 648 362 Z' },
  { state: 'KY', path: 'M 648 367 L 745 370 L 743 405 L 646 402 Z' },
  { state: 'TN', path: 'M 590 377 L 760 380 L 758 420 L 588 417 Z' },
  { state: 'AL', path: 'M 630 422 L 695 425 L 693 480 L 628 477 Z' },
  { state: 'OH', path: 'M 705 307 L 770 310 L 768 370 L 703 367 Z' },
  { state: 'WV', path: 'M 745 372 L 805 375 L 803 415 L 743 412 Z' },
  { state: 'VA', path: 'M 760 382 L 860 385 L 858 425 L 758 422 Z' },
  { state: 'NC', path: 'M 758 424 L 875 427 L 873 465 L 756 462 Z' },
  { state: 'SC', path: 'M 756 464 L 820 467 L 818 500 L 754 497 Z' },
  { state: 'GA', path: 'M 695 427 L 775 430 L 773 500 L 693 497 Z' },
  { state: 'FL', path: 'M 775 502 L 825 505 L 830 540 L 815 555 L 795 550 L 785 565 L 770 555 L 760 540 L 773 520 Z' },
  { state: 'PA', path: 'M 770 312 L 860 315 L 858 360 L 768 357 Z' },
  { state: 'NY', path: 'M 770 245 L 875 248 L 873 310 L 768 307 Z' },
  { state: 'VT', path: 'M 875 210 L 900 212 L 898 245 L 873 243 Z' },
  { state: 'NH', path: 'M 900 200 L 920 202 L 918 235 L 898 233 Z' },
  { state: 'MA', path: 'M 875 250 L 935 253 L 933 275 L 873 272 Z' },
  { state: 'RI', path: 'M 920 260 L 935 262 L 933 275 L 918 273 Z' },
  { state: 'CT', path: 'M 875 277 L 920 280 L 918 300 L 873 297 Z' },
  { state: 'NJ', path: 'M 860 317 L 885 320 L 883 355 L 858 352 Z' },
  { state: 'DE', path: 'M 860 362 L 880 365 L 878 385 L 858 382 Z' },
  { state: 'MD', path: 'M 805 377 L 875 380 L 873 400 L 803 397 Z' },
  { state: 'ME', path: 'M 920 150 L 945 152 L 943 210 L 918 208 Z' },
];
---

<div class="not-prose my-12 p-8 rounded-2xl bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 border border-slate-200 dark:border-slate-700 shadow-lg">
  <h3 class="text-2xl font-bold text-slate-900 dark:text-white mb-6 text-center">{title}</h3>
  <svg viewBox="0 0 960 600" class="w-full max-w-4xl mx-auto" style="filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));">
    <!-- HI (Hawaii) - rendered as circles -->
    <circle cx="220" cy="560" r="8" class={getStateClass('HI')} stroke="white" stroke-width="1.5"/>
    <circle cx="240" cy="565" r="6" class={getStateClass('HI')} stroke="white" stroke-width="1.5"/>
    <circle cx="260" cy="558" r="5" class={getStateClass('HI')} stroke="white" stroke-width="1.5"/>

    <!-- DC (Washington DC) - rendered as circle -->
    <circle cx="850" cy="390" r="4" class={getStateClass('DC')} stroke="white" stroke-width="1.5"/>

    <!-- All other states -->
    {statePaths.map(({ state, path }) => (
      <path
        d={path}
        class={getStateClass(state)}
        stroke="white"
        stroke-width="1.5"
      >
        <title>{state}</title>
      </path>
    ))}
  </svg>

  <div class="mt-8 flex items-center justify-center gap-6 text-sm">
    <div class="flex items-center gap-2">
      <div class="w-5 h-5 rounded bg-brand-500 dark:bg-brand-600 shadow-sm"></div>
      <span class="text-slate-700 dark:text-slate-300 font-medium">Coverage Available ({states.length} {states.length === 1 ? 'state' : 'states'})</span>
    </div>
    <div class="flex items-center gap-2">
      <div class="w-5 h-5 rounded bg-slate-300 dark:bg-slate-700 shadow-sm"></div>
      <span class="text-slate-600 dark:text-slate-400">Not Available</span>
    </div>
  </div>
</div>
